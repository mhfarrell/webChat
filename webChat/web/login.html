<html >
<head>
    <meta charset="UTF-8">
    <title>webChat</title>
    <link rel="stylesheet" href="style/style.css">
</head>
  <body>
    <div id="login-page">
      <div id="login-form">
        <div id="social-buttons">
          <div><span>Login via</span></div>
          <a href="/auth/facebook">
            <img id="fbLogin" class="loginBtn" src="images/facebookLoginBtn.png" alt="Sign-In with Facebook">
          </a>
          <a href="/auth/twitter">
            <img id="twitLogin" class="loginBtn" src="images/twitterLoginBtn.png" alt="Sign-In with Twitter">
          </a>
        </div>
        <div style="margin-top: 18px;">
            <form action="/register" id="register" class="register-form" method="post">
              <input type="text" name="username" placeholder="username"/>
              <input type="password" name="password" placeholder="password"/>
              <button type="submit">create</button>
              <p class="message">Already registered? <a href="#">Sign In</a></p>
            </form>
            <form action="/login" id="login" class="login-form" method="post">
              <input type="text" name="username" placeholder="username"/>
              <input type="password" name="password" placeholder="password"/>
              </br>
			  <button type="submit">login</button>
              <p class="message">Not registered? <a href="#">Create an account</a></p>
            </form>
        </div>
    </div> <!-- end form -->
	{% raw xsrf_form_html() %}
    </div> <!-- end login container -->
    <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js'></script>

    <script>
        $('.message a').click(function(){
            $('form, .social-buttons').animate({height: "toggle", opacity: "toggle"}, "slow");
          });
		 
		function ConvertFormToJSON(form){
			var array = jQuery(form).serializeArray();
			var json = {};
			
			jQuery.each(array, function() {
				json[this.name] = this.value || '';
			});
			
			return json;
		}

		jQuery(document).on('ready', function() {
			jQuery('form#register').bind('submit', function(event){
				event.preventDefault();
				
				var form = this;
				var json = ConvertFormToJSON(form);
				
				$.ajax({
					type: "POST",
					url: "/register",
					data: json,
					dataType: "json"
				}).fail(function() { 
					alert("Failed to send"); 
				});

				return true;
			});
		});		
    </script>
  </body>
</html>

